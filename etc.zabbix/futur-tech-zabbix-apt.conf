# Count available package updates, separating standard updates from security updates
UserParameter=apt.upd_others,apt-get -q=2 --simulate -o=APT::Get::Show-User-Simulation-Note=no upgrade | grep --count --perl-regexp '^Inst ((?!-security).)*$'
UserParameter=apt.upd_security,apt-get -q=2 --simulate -o=APT::Get::Show-User-Simulation-Note=no upgrade | grep --count '^Inst .*-security'

# Detect whether a kernel update is available (returns 1 if yes, otherwise 0)
UserParameter=apt.upd_kernel,apt-get -q=2 --simulate -o=APT::Get::Show-User-Simulation-Note=no upgrade | grep --quiet '^Inst linux-image-.*' && echo 1 || echo 0

# List all packages that can be upgraded
UserParameter=apt.upd_list,apt list --upgradable -q=2 2>/dev/null

# List packages placed on hold (prevented from upgrading)
UserParameter=apt.hold_list,apt-mark showhold 2>/dev/null

# List packages that would be removed by an autoremove operation
UserParameter=apt.autoremove_list,apt-get -q=2 --simulate -o=APT::Get::Show-User-Simulation-Note=no autoremove 2>/dev/null

# Check kernel.
UserParameter=needrestart.kernel,sudo needrestart -b -k | grep 'NEEDRESTART-KSTA' | cut -d ':' -f2 | cut -c2-

# Services or processes needing restart after library upgrades.
UserParameter=needrestart.svc,sudo needrestart -b -l | grep 'NEEDRESTART-SVC' | cut -d':' -f2 | cut -c2-
UserParameter=needrestart.pid,sudo needrestart -b -l | grep 'NEEDRESTART-PID' | cut -d':' -f2 | cut -c2-

# Installed packages that are not marked as 'ok' in the dpkg database.
UserParameter=dpkg.broken,dpkg-query -W -f '${db:Status-Eflag} ${db:Status-Status} ${binary:Package}\n' | cut -d ' ' -f 1 | grep -i -v 'ok'

# Installed packages that are in a potentially problematic state (i.e., not 'installed' or 'config-files').
UserParameter=dpkg.problematic,dpkg-query -W -f '${db:Status-Status} ${binary:Package}\n' | cut -d ' ' -f 1 | grep -i -v -e 'installed' -e 'config-files'

